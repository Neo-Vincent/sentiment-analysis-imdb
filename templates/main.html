<!doctype html>
<html lang="en">
  <head>
    <title>Sentiment Analysis</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <!--<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">-->
    <link rel="stylesheet" href="https://bootswatch.com/lumen/bootstrap.css">

    <!-- Optional theme -->
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
      .table { table-layout:fixed; }
      td.text { color: #666; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; cursor: pointer; }
      td.text.hover { white-space: normal; overflow: visible;  }
      td.danger, td.success { opacity: 0.75; }
      .alert { font-size: 120% }
      .notice { color: #999; padding-top: 10px; margin-bottom: -15px; }
      body { background: #333 }
      .container { background: #fff; padding: 15px; }
    </style>

    <script type="text/javascript">
      window.CLASSES = ["Negative", "Positive"]
      window.CSS_CLASSES = ["danger", "success"]

      var progressBar = {
        show: function() {
          $(".progress").fadeIn();
        },
        hide: function() {
          $(".progress").hide();
        }
      };

      var prediction = {
        set: function(q, predictedValue, predictedClass) {
          $("#predicted_class").text(CLASSES[predictedClass]);
          $("#predicted_value").text(predictedValue);
          $("#predicted_query").text(q);
          prediction.toggleClasses(predictedClass);
        },
        toggleClasses: function(predictedClass) {
          $("#prediction").removeClass("alert-" + CSS_CLASSES[1 - predictedClass]);
          $("#prediction").addClass("alert-" + CSS_CLASSES[predictedClass]);
        },
        show: function() {
          $("#prediction").fadeIn();
        },
        hide: function() {
          $("#prediction").hide();
        }
      };

      var examples = {
        show: function() {
          $(".examples").fadeIn(1500);
        },
        add: function(q, actual, predicted) {
          $line = $("<tr>")
            $div = $("<div>").html(q)
            $line.append($("<td class='text'>").text($div.text()));
            $line.append(examples.classCell(actual));
            $line.append(examples.classCell(predicted));
            $(".example_items").append($line);
        },
        addAll: function(items) {
          $.each(items, function(i, item){
              actual = parseInt(item.actual);
              expected = parseInt(item.expected);
              examples.add(item.q, actual, expected);
          });
        },
        classCell: function(value){
          return $("<td>").text(CLASSES[value]).addClass(CSS_CLASSES[value]);
        }
      }

      $(function(){
        $("#predict_form").submit(function(e){
          e.preventDefault();
          prediction.hide();
          progressBar.show();

          $.getJSON("/predict",  $(this).serialize()).
            always(function(){
              progressBar.hide();
            }).
            done(function(data) {
              var predictedClass = parseInt(data.predicted_class);
              prediction.set(data.q, data.prediction, predictedClass);
              prediction.show();
            });
        });

        $.getJSON("/examples").done(function(data) {
          examples.addAll(data.items);
          examples.show()

          $("td.text").click(function(){
            $(this).toggleClass("hover",10000)
          });
        });
      });
    </script>
  </head>
  <body>
    <div class="container">
      <div class="jumbotron">
        <h1>Sentiment Analysis <small> IMDB Reviews </small></h1>
        <p>Showcase of a project developed for the Natural Language Processing course at UFMG. This aims to classify movie reviews based on knowledge acquired by training a recurrent neural network (LSTM) on IMDB reviews database.</p>
        <div id="prediction" class="collapse alert alert-success" role="alert">
          <strong>
            <span id="predicted_class">Positive</span>
            (<span id="predicted_value"></span>)!
          </strong>
          <span id="predicted_query">=)</span>
        </div>
        <div class="progress collapse">
          <div class="progress-bar progress-bar-striped progress-bar-info active" role="progressbar" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
            <span class="sr-only">Loading</span>
          </div>
        </div>
        <form action="/predict" class="form-group-lg" id="predict_form">
          <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="Enter your sentence here, e.g. 'The Godfather is my favorite movie of all times'.">
            <span class="input-group-btn">
              <input class="btn btn-info btn-lg" type="submit" value="Classify">
            </span>
          </div>
        </form>
        <div class="notice">
          <small>
            (*) There are two classes: Negative (0) and Positive(1); 0 &ge; Negative &le; 0.5  &gt; Positive &le; 1
          </small>
        </div>
      </div>

      <div class="examples collapse">
        <h2 class="page-header">Randomly selected examples</h2>
        <table class="table table-hover table-bordered table-striped">
          <thead>
            <tr>
              <th width="70%"> Review </th>
              <th> Actual </th>
              <th> Expected </th>
            </tr>
          </thead>
          <tbody class="example_items">
            <!-- Dinamically filled -->
          </tbody>
        </table>
      </div>
      <hr>
      <h3 class="page-header">References</h3>
      <p><strong>A. L. Maas, R. E. Daly, P. T. Pham, D. Huang, A. Y. Ng, and C. Potts.</strong> Learning word vectors for sentiment analysis. In <em>Proceedings of the 49th Annual Meeting of the Association for Computational Linguistics: Human Language Technologies</em>, pages 142-150, Portland, Oregon, USA, June 2011. Association for Computational Linguistics <a class="url" href="http://www.aclweb.org/anthology/P11-1015">(view online)</a>.</p>
    </div>
  </body>
</html>
